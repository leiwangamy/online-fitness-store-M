{% extends "admin/base_site.html" %}
{% load static %}

{% block branding %}
  <div class="admin-nav-links">
    <a href="{% url 'home:home' %}">Home</a>
    {% if admin_settings.show_platform_membership %}
    <a href="{% url 'members:my_membership' %}">Membership</a>
    {% endif %}
    <a href="{% url 'cart:cart_detail' %}">Cart</a>
  </div>
  
  <div class="site-admin-header">
    <div class="admin-account-area">
      {% if user.is_authenticated %}
        ğŸ‘¤ You are logged in as <strong>{{ user.username }}</strong>
      {% endif %}
      {% if user.is_staff and has_pending_refunds %}
        <span style="margin-left: 20px; background: #ffc107; color: #856404; padding: 5px 10px; border-radius: 4px; font-weight: bold;">
          âš  Refund Requests ({{ pending_refunds_count }})
        </span>
        <a href="{% url 'admin:orders_refund_changelist' %}?status__exact=requested" style="margin-left: 10px; color: #856404; text-decoration: underline;">
          â†’ Review
        </a>
      {% endif %}
    </div>
    {% if user.is_staff %}
    <div class="admin-control-buttons" style="margin-left: auto; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
      <form method="post" action="{% url 'admin_toggle_platform_membership' %}" style="margin: 0;">
        {% csrf_token %}
        <button type="submit" class="admin-control-btn" style="background: {% if admin_settings.show_platform_membership %}#28a745{% else %}#6c757d{% endif %}; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 14px;">
          {% if admin_settings.show_platform_membership %}ğŸ‘ï¸ Hide{% else %}ğŸ‘ï¸â€ğŸ—¨ï¸ Show{% endif %} Platform Membership
        </button>
      </form>
      <form method="post" action="{% url 'admin_toggle_seller_membership' %}" style="margin: 0;">
        {% csrf_token %}
        <button type="submit" class="admin-control-btn" style="background: {% if admin_settings.show_seller_membership %}#28a745{% else %}#6c757d{% endif %}; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 14px;">
          {% if admin_settings.show_seller_membership %}ğŸ‘ï¸ Hide{% else %}ğŸ‘ï¸â€ğŸ—¨ï¸ Show{% endif %} Seller Membership
        </button>
      </form>
      <a href="{% url 'admin_backup_database' %}" class="admin-control-btn" style="background: #007bff; color: white; text-decoration: none; padding: 8px 16px; border-radius: 4px; font-weight: bold; font-size: 14px; display: inline-block;">
        ğŸ’¾ Backup Database
      </a>
    </div>
    {% endif %}
  </div>
{% endblock %}

{% block content %}
  {% if user.is_staff and has_pending_refunds %}
    <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 15px; margin: 10px 0; border-radius: 4px;">
      <strong style="color: #856404;">âš  You have {{ pending_refunds_count }} pending refund request{{ pending_refunds_count|pluralize }}.</strong>
      <a href="{% url 'admin:orders_refund_changelist' %}?status__exact=requested" style="margin-left: 10px; color: #856404; text-decoration: underline; font-weight: bold;">
        â†’ Review Refund Requests
      </a>
    </div>
  {% endif %}
  {{ block.super }}
{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'css/admin_custom.css' %}">
{% endblock %}

